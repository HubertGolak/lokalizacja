<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Dane z czujników iPhone</title>
</head>
<body>
  <h1>Odczyt z akcelerometru i żyroskopu</h1>
  <button onclick="startSensors()">Pokaż dane</button>

  <script>
    function startSensors() {
      // iOS (13+) – wymaga zgody
      if (typeof DeviceMotionEvent.requestPermission === 'function') {
        DeviceMotionEvent.requestPermission()
          .then(response => {
            if (response === 'granted') {
              enableMotionListener();
            } else {
              alert('Brak zgody na dostęp do czujników.');
            }
          })
          .catch(error => {
            console.error(error);
            alert('Błąd przy uzyskiwaniu zgody.');
          });
      } else {
        // Android lub starszy iOS
        enableMotionListener();
      }
    }

    function enableMotionListener() {
      window.addEventListener('devicemotion', function(event) {
        const acc = event.accelerationIncludingGravity;
        const rot = event.rotationRate;

        const accX = acc?.x?.toFixed(2);
        const accY = acc?.y?.toFixed(2);
        const accZ = acc?.z?.toFixed(2);

        const rotAlpha = rot?.alpha?.toFixed(2); // obrót wokół osi Z
        const rotBeta = rot?.beta?.toFixed(2);   // obrót wokół osi X
        const rotGamma = rot?.gamma?.toFixed(2); // obrót wokół osi Y

        alert(
          `Akcelerometr:\nX: ${accX}\nY: ${accY}\nZ: ${accZ}\n\n` +
          `Żyroskop:\nAlpha (Z): ${rotAlpha}\nBeta (X): ${rotBeta}\nGamma (Y): ${rotGamma}`
        );

        // Po pierwszym odczycie przestaje słuchać
        window.removeEventListener('devicemotion', arguments.callee);
      });
    }
  </script>
</body>
</html>
