<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Czujniki iPhone</title>
</head>
<body>
  <h1>Sprawdź położenie telefonu</h1>
  <button onclick="readSensorsOnce()">Odczytaj czujniki</button>

  <script>
    async function readSensorsOnce() {
      // iOS: uzyskanie zgody na dostęp
      if (typeof DeviceMotionEvent.requestPermission === 'function') {
        try {
          const response = await DeviceMotionEvent.requestPermission();
          if (response !== 'granted') {
            alert('Odmowa dostępu do czujników.');
            return;
          }
        } catch (err) {
          alert('Błąd przy uzyskiwaniu zgody: ' + err);
          return;
        }
      }

      // Jednorazowy nasłuch
      const handler = (event) => {
        const acc = event.accelerationIncludingGravity || {};
        const rot = event.rotationRate || {};

        const accX = acc.x?.toFixed(2);
        const accY = acc.y?.toFixed(2);
        const accZ = acc.z?.toFixed(2);

        const rotAlpha = rot.alpha?.toFixed(2);
        const rotBeta = rot.beta?.toFixed(2);
        const rotGamma = rot.gamma?.toFixed(2);

        alert(
          `Akcelerometr:\nX: ${accX}\nY: ${accY}\nZ: ${accZ}\n\n` +
          `Żyroskop:\nAlpha (Z): ${rotAlpha}\nBeta (X): ${rotBeta}\nGamma (Y): ${rotGamma}`
        );

        window.removeEventListener('devicemotion', handler);
      };

      // Dodanie nasłuchu
      window.addEventListener('devicemotion', handler, { once: true });
    }
  </script>
</body>
</html>
